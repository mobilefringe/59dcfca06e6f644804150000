<div class="header_banner" id="top_banner">
    <div class="main_container">
        <h4 class="header_banner_heading">Leasing</h4>
    </div>
</div>
<div class="main_container mobile_padding">
    <div class="details_row">
        <div class="details_col_3 hidden_phone">
            <img id="side_image" src="//codecloud.cdn.speedyrails.net/sites/57f503036e6f6454f2010000/image/jpeg/undefined/lbtc_440x1200_side_events.jpg" />
        </div>
        <div class="details_col_9">
            <div id="mm_page_content" class="details_desc"></div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        loadMallDataCached(renderPage);
    })
    
    function renderPage(){
        var prefix = get_prefix();
        var pages_json = prefix + "/pages/eglinton-community.json"
        $.getJSON(pages_json).done(function(data) {
            $('#mm_page_content').html(data.body);
        }).fail(function(jqXHR) {
            if (jqXHR.status == 404) {
                $("#404_msg").fadeIn("fast");
            }
        }); 
        
        show_content();
    }
    
    function validateEmail(){
        var $email = $('#email'); //change form to id or containment selector
        var re = /[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;
    
        if ($email.val() == '' || !re.test($email.val())){
            return false;
        }
        return true;
    }
    	
	function sendEmail(){
	    var operatingName = $('#operatingName').val();
	    var fax =  $('#fax').val();
	    var lottery = $('#lottery').val();

	    if($('#operatingName').val().length === 0){
	        operatingName = 'N/A';
	    }
	    
	    if($('#fax').val().length === 0){
	        fax = 'N/A';
	    }
	    
	    if($('#lottery').val().length === 0){
	        lottery = 'N/A';
	    }

        $.ajax({
            url : "//mallmaverick.com/send_contact_email",
            type: "POST",
            data : { 
                'send_to': "DNeely@Bentallkennedy.com,ngoverde@bentallkennedy.com", 
                'subject': "Eglinton Square Community Rental Form Application", 
                'body': {
                    "Legal Name of Organization": $('#legalName').val(), 
                    "Operating Name of Organization(if different)": operatingName, 
                    "Description of Organization": $('#descOrg').val(), 
                    "Street Address":$('#address').val(),
                    "Town/City":$('#city').val(), 
                    "Postal Code" : $('#postal').val(), 
                    "Email Address":$('#email').val(), 
                    "Telephone Number": $('#phone').val(), 
                    "Fax Number": fax,
                    "Authorized Contact Person":$('#contactName').val(),
                    "Name of Insurer": $('#insurerName').val(),
                    "Charitable # (BN/Registration Number)": $('#charitable').val(),
                    "Lottery License # (If applicable)":  $('#lottery').val(),
                    "From Date(mm/dd/yyyy)":  $('#fromDate').val(),
                    "To Date(mm/dd/yyyy)":  $('#toDate').val(),
                    "Purpose for use of in-mall space":  $('#purpose').val(),
                    "Please specify any other requirements":  $('#anyother').val(),
                    "Anticipated Attendance":  $('#attendance').val()
                } 
            },
            success: function(data, textStatus, jqXHR) {
                $('#send_contact_success').fadeIn();
                $('#community_form').find("input, textarea, select").val("");
              
                $("select option[value=0]").attr("selected", true);
                $("html, body").animate({ scrollTop:  $("#send_contact_success").offset().top }, 1000);
            },
            error: function (jqXHR, textStatus, errorThrown) {
                $('#send_contact_error').fadeIn();
                $("html, body").animate({ scrollTop:  $("#send_contact_error").offset().top }, 1000);
            }
        });
	}
</script>