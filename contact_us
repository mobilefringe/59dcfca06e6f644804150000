<div class="header_banner" id="top_banner">
    <div class="main_container">
        <h4 class="header_banner_heading">Contact Us</h4>
    </div>
</div>
<div class="main_container mobile_padding">
    <div class="details_row">
        <div class="details_col_3 hidden_phone">
            <div id="mm_page_content" class="details_desc"></div>
        </div>
        <div class="details_col_9">

            <p class="details_desc">We value your feedback. Send us your comments or questions by completing the contact form below.</p>
            <div id="send_contact_success" class="alert alert-success hidden_now" role="alert">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                <span class="sr-only">Success</span>
                Thank you for contacting us. A member from our team will contact you shortly. 
            </div>
            <div id="send_contact_error" class="alert alert-danger hidden_now" role="alert">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Error:</span>
                There was an error when trying to submit your request. Please ensure you have entered a valid email address and subject and try again.
            </div>
            <form name="contact_form" id="contact_form" method="post">
                <div class="row">
                    <div class="col-sm-6">
                        <label for="name">Name</label>
                        <input name="name" id="name" class="form-control" type="text" value="" required data-validation="required">
                    </div>
                    <div class="col-sm-6">
                        <label for="email" >E-mail</label>
                        <input name="email" id="email" class="form-control" type="text" value="" required data-validation="required">
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="subject">Subject</label>
                        <input name="subject" id="subject" class="form-control" type="text" required data-validation="required">
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="message">Message</label>
                        <textarea name="message" id="message" rows="8" class="form-control" required data-validation="required"></textarea>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-12 col-md-6">
                        <label for="enterVerify">Enter the following number below to proceed: <div id="verifyNum"></div></label>
                        <br>
                        <input type="hidden" value="701469" id="verifyNumHidden" name="verifyNumHidden" />
                        <input class="form-control" type="text" id="enterVerify" name="enterVerify" required data-validation="required"/>
                    </div>
                </div>
                <br>
                <br>
                <br>
                <div class="row">
                    <div class="col-sm-12 col-md-6">
                        <button id="submit" class="btn btn-primary" type="submit">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        loadMallDataCached(renderPage);
    })
    
    function renderPage(){
        var pathArray = window.location.pathname.split( '/' );
        var slug = pathArray[pathArray.length-1];
    
        var prefix = get_prefix();
        var pages_json = prefix + "/pages/eglinton-contact-us.json"
        $.getJSON(pages_json).done(function(data) {
            $('#mm_page_content').html(data.body);
        }).fail(function(jqXHR) {
            if (jqXHR.status == 404) {
                $("#404_msg").fadeIn("fast");
            }
        }); 
            
        $.validate();
        
        randomgen();
        
        show_content();
        
        $('#contact_form').submit(function(e) {
            if($('#enterVerify').val() == $('#verifyNumHidden').val() ) {
                values = [];
                values = JSON.stringify($('#contact_form').serializeArray());
                e.preventDefault();
                $.ajax({
                    url : "/api/v1/contact_us",
                    type: "POST",
                    data : {authenticity_token: '<%=form_authenticity_token%>' ,
                    form_data:values},
                    success: function(data, textStatus, jqXHR){
                        $('#send_contact_success').fadeIn();
                        $('#contact_form').find("input[type=text], textarea").val("");
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        $('#send_contact_error').fadeIn();
                    }
                });
            } else {
                alert("Please Enter Correct Verification Number");
                randomgen();
                e.preventDefault();
            }
        });
    }
    
    function randomgen() {
        var rannumber='';
        for(ranNum=1; ranNum<=6; ranNum++){
            rannumber+=Math.floor(Math.random()*10).toString();
        }
        $('#verifyNum').html(rannumber);
        $('#verifyNumHidden').val(rannumber);
    }
</script>